/*
 * Copyright (C) 2008-2024 Advanced Micro Devices, Inc. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors
 *    may be used to endorse or promote products derived from this software without
 *    specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 * OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 */

#include <fenv.h>
#include "almstruct.h"
#include <libm_util_amd.h>
/*
 * Test cases to check for exceptions for the cbrtf() routine.
 * These test cases are not exhaustive
 * These values as as per GLIBC output
 */
static libm_test_special_data_f32
test_cbrtf_conformance_data[] = {
   // special accuracy tests
   {0x38800000, 0x3f800000,  0},  //min= 0.00006103515625, small enough that cbrt(x) = 1
   {0x387FFFFF, 0x3f800000,  0}, //min - 1 bit
   {0x38800001, 0x3f800000,  0}, //min + 1 bit
   #if defined(_WIN64) || defined(_WIN32)
       {0xF149F2C9, 0x7f800000,  FE_INEXACT}, //lambda + x = 1, x = -9.9999994e+29
       {0xF149F2C8, 0x7f800000,  FE_INEXACT}, //lambda + x < 1
       {0xF149F2CA, 0x7f800000,  FE_INEXACT}, //lambda + x > 1
       {0x42B2D4FD, 0x7f800000,  FE_INEXACT}, //max arg + 1 bit
       {0x42B2D4FF, 0x7f800000,  FE_INEXACT}, // > max
       {0x43b3c4ea, 0x7f800000,  FE_INEXACT},  // normal intermediate
       {0x7f7fffff, 0x7f800000,  FE_INEXACT},  // normal max
       {0xc5812e71, 0x7f800000,  FE_INEXACT},  // -normal intermediate
       {0xFF7FFFFF, 0x7f800000,  FE_INEXACT},  // -normal max
       {0x447A0000, 0x7f800000,  FE_INEXACT},  // 1000
       {0xc47A0000, 0x7f800000,  FE_INEXACT},  // -1000
       {0x44F7F333, 0x7f800000,  FE_INEXACT},  // 1983.6
       {0xc4F7F333, 0x7f800000,  FE_INEXACT},  // -1983.6
       {0x48015E40, 0x7f800000,  FE_INEXACT},  // 132473
       {0xc8015E40, 0x7f800000,  FE_INEXACT},  // -132473
       {0x4B000000, 0x7f800000,  FE_INEXACT},  // 2^23
       {0x4B000001, 0x7f800000,  FE_INEXACT},  // 2^23 + 1
       {0xcB000000, 0x7f800000,  FE_INEXACT},  // -2^23
       {0xcB000001, 0x7f800000,  FE_INEXACT},  // -(2^23 + 1)
       {0xcAFFFFFF, 0x7f800000,  FE_INEXACT},  // -(2^23 -1 + 0.5)
       {0x4AFFFFFF, 0x7f800000,  FE_INEXACT},  // 2^23 -1 + 0.5
    #else
       {0xF149F2C9, 0x7f800000,  FE_OVERFLOW}, //lambda + x = 1, x = -9.9999994e+29
       {0xF149F2C8, 0x7f800000,  FE_OVERFLOW}, //lambda + x < 1
       {0xF149F2CA, 0x7f800000,  FE_OVERFLOW}, //lambda + x > 1
       {0x42B2D4FD, 0x7f800000,  FE_OVERFLOW}, //max arg + 1 bit
       {0x42B2D4FF, 0x7f800000,  FE_OVERFLOW}, // > max
       {0x43b3c4ea, 0x7f800000,  FE_OVERFLOW},  // normal intermediate
       {0x7f7fffff, 0x7f800000,  FE_OVERFLOW},  // normal max
       {0xc5812e71, 0x7f800000,  FE_OVERFLOW},  // -normal intermediate
       {0xFF7FFFFF, 0x7f800000,  FE_OVERFLOW},  // -normal max
       {0x447A0000, 0x7f800000,  FE_OVERFLOW},  // 1000
       {0xc47A0000, 0x7f800000,  FE_OVERFLOW},  // -1000
       {0x44F7F333, 0x7f800000,  FE_OVERFLOW},  // 1983.6
       {0xc4F7F333, 0x7f800000,  FE_OVERFLOW},  // -1983.6
       {0x48015E40, 0x7f800000,  FE_OVERFLOW},  // 132473
       {0xc8015E40, 0x7f800000,  FE_OVERFLOW},  // -132473
       {0x4B000000, 0x7f800000,  FE_OVERFLOW},  // 2^23
       {0x4B000001, 0x7f800000,  FE_OVERFLOW},  // 2^23 + 1
       {0xcB000000, 0x7f800000,  FE_OVERFLOW},  // -2^23
       {0xcB000001, 0x7f800000,  FE_OVERFLOW},  // -(2^23 + 1)
       {0xcAFFFFFF, 0x7f800000,  FE_OVERFLOW},  // -(2^23 -1 + 0.5)
       {0x4AFFFFFF, 0x7f800000,  FE_OVERFLOW},  // 2^23 -1 + 0.5
    #endif
   {0x42B2D4FC, 0x7f7fffec,  0}, //max arg, x = 89.41598629223294,max cbrtf arg
   {0x42B2D4FB, 0x7f7fff6c,  0}, //max arg - 1 bit
   {0x42B2D400, 0x7f7f820b,  0}, // < max
   {0x41A00000, 0x4d675844,  0}, //small_threshold = 20
   {0x41A80000, 0x4e1d3710,  0}, //small_threshold+1 = 21
   {0x41980000, 0x4caa36c8,  0}, //small_threshold - 1 = 19

    //cbrt special exception checks
   {POS_ZERO_F32, 0x3f800000,0 },  //0
   {NEG_ZERO_F32, 0x3f800000,0 },  //0
   {POS_INF_F32,  POS_INF_F32,0 },
   {NEG_INF_F32,  NEG_INF_F32,0 },
   {POS_SNAN_F32, POS_SNAN_F32, FE_INVALID },  //
   {NEG_SNAN_F32, NEG_SNAN_F32, FE_INVALID },  //
   {POS_QNAN_F32, POS_QNAN_F32, 0 },  //
   {NEG_QNAN_F32, NEG_QNAN_F32, 0 },  //
   {POS_INF_F32,  POS_INF_F32,  FE_OVERFLOW },  //95

   {0x00000001, 0x3f800000,  0},  // denormal min
   {0x0005fde6, 0x3f800000,  0},  // denormal intermediate
   {0x007fffff, 0x3f800000,  0},  // denormal max
   {0x80000001, 0x3f800000,  0},  // -denormal min
   {0x805def12, 0x3f800000,  0},  // -denormal intermediate
   {0x807FFFFF, 0x3f800000,  0},  // -denormal max
   {0x00800000, 0x3f800000,  0},  // normal min
   {0x80800000, 0x3f800000,  0},  // -normal min
   {0x7F800000, 0x7f800000,  0},  // inf
   {0xfF800000, 0x7f800000,  0},  // -inf
   {0x7Fc00000, 0x7fc00000,  0},  // qnan min
   {0x7Fe1a570, 0x7fe1a570,  0},  // qnan intermediate
   {0x7FFFFFFF, 0x7fffffff,  0},  // qnan max
   {0xfFc00000, 0xffc00000,  0},  // indeterninate
   {0xFFC00001, 0xffc00001,  0},  // -qnan min
   {0xFFd2ba31, 0xffd2ba31,  0},  // -qnan intermediate
   {0xFFFFFFFF, 0xffffffff,  0},  // -qnan max
   {0x7F800001, 0x7fc00001,  FE_INVALID},  // snan min
   {0x7Fa0bd90, 0x7fe0bd90,  FE_INVALID},  // snan intermediate
   {0x7FBFFFFF, 0x7fffffff,  FE_INVALID},  // snan max
   {0xFF800001, 0xffc00001,  FE_INVALID},  // -snan min
   {0xfF95fffa, 0xffd5fffa,  FE_INVALID},  // -snan intermediate
   {0xFFBFFFFF, 0xffffffff,  FE_INVALID},  // -snan max
   {0x3FC90FDB, 0x40209662,  0},  // pi/2
   {0x40490FDB, 0x413978a5,  0},  // pi
   {0x40C90FDB, 0x4385df97,  0},  // 2pi
   {0x402DF853, 0x40f38620,  0},  // e --
   {0x402DF854, 0x40f38624,  0},  // e
   {0x402DF855, 0x40f38628,  0},  // e ++
   {0x00000000, 0x3f800000,  0},  // 0
   {0x37C0F01F, 0x3f800000,  0},  // 0.000023
   {0x3EFFFEB0, 0x3f9055e0,  0},  // 0.49999
   {0x3F0000C9, 0x3f905641,  0},  // 0.500012
   {0x80000000, 0x3f800000,  0},  // -0
   {0xb7C0F01F, 0x3f800000,  0},  // -0.000023
   {0xbEFFFEB0, 0x3f9055e0,  0},  // -0.49999
   {0xbF0000C9, 0x3f905641,  0},  // -0.500012
   {0x3f800000, 0x3fc583ab,  0},  // 1
   {0x3f700001, 0x3fbc7e14,  0},  // 0.93750006
   {0x3F87FFFE, 0x3fcf4ed3,  0},  // 1.0624998
   {0x3FBFFFAC, 0x40168d88,  0},  // 1.49999
   {0x3FC00064, 0x40168e4c,  0},  // 1.500012
   {0xbf800000, 0x3fc583ab,  0},  // -1
   {0xbf700001, 0x3fbc7e14,  0},  // -0.93750006
   {0xbF87FFFE, 0x3fcf4ed3,  0},  // -1.0624998
   {0xbFBFFFAC, 0x40168d88,  0},  // -1.49999
   {0xbFC00064, 0x40168e4c,  0},  // -1.500012
   {0xc0000000, 0x4070c7d0,  0},  // -2
   {0x41200000, 0x462c14ef,  0},  // 10
   {0xc1200000, 0x462c14ef,  0},  // -10
   {0x4286CCCC, 0x6f96eb6f,  0},  // 67.4
   {0xc286CCCC, 0x6f96eb6f,  0},  // -67.4
   {0x42AF0000, 0x7e16bab3,  0},  // 87.5
   {0xc2AF0000, 0x7e16bab3,  0},  // -87.5
   // added from ancient libm repo
   {0x1,0X26a14518}, // 1.4013e-45
   {0x5fde6,0X29b88612}, // 5.50259e-40
   {0x3fa00000,0X3f89e242}, // 1.25
   {0x3e000000,0X3f000000}, // 0.125
   {0x3ec00000,0X3f389ba2}, // 0.375
   {0x3f200000,0X3f5ae07e}, // 0.625
   {0x3e800000,0X3f214518}, // 0.25
   {0x3f000000,0X3f4b2ff5}, // 0.5
   {0x3fc00000,0X3f9285ff}, // 1.5
   {0x40100000,0X3fa7ba3a}, // 2.25
   {0x40200000,0X3fadb905}, // 2.5
   {0x40800000,0X3fcb2ff5}, // 4
   {0x40880000,0X3fcf55cd}, // 4.25
   {0x40900000,0X3fd352c7}, // 4.5
   {0x41000000,0X40000000}, // 8
   {0x41040000,0X400151d7}, // 8.25
   {0x41080000,0X40029ceb}, // 8.5
   {0x41800000,0X40214518}, // 16
   {0x41820000,0X40221b02}, // 16.25
   {0x41840000,0X4022eebe}, // 16.5
   {0x42000000,0X404b2ff5}, // 32
   {0x42010000,0X404bb711}, // 32.25
   {0x42020000,0X404c3d7a}, // 32.5
   {0x42800000,0X40800000}, // 64
   {0x42808000,0X40802a9c}, // 64.25
   {0x42810000,0X4080551d}, // 64.5
   {0x43000000,0X40a14518}, // 128
   {0x43004000,0X40a15ff4}, // 128.25
   {0x43008000,0X40a17ac8}, // 128.5
   {0x43800000,0X40cb2ff5}, // 256
   {0x43802000,0X40cb40e2}, // 256.25
   {0x43804000,0X40cb51cd}, // 256.5
   {0x44000000,0X41000000}, // 512
   {0x44001000,0X41000555}, // 512.25
   {0x44002000,0X41000aaa}, // 512.5
   {0x44800000,0X41214518}, // 1024
   {0x44800800,0X41214874}, // 1024.25
   {0x44801000,0X41214bd0}, // 1024.5
   {0x45000000,0X414b2ff5}, // 2048
   {0x45000400,0X414b3213}, // 2048.25
   {0x45000800,0X414b3431}, // 2048.5
   {0x45800000,0X41800000}, // 4096
   {0x45800200,0X418000ab}, // 4096.25
   {0x45800400,0X41800155}, // 4096.5
   {0x46000000,0X41a14518}, // 8192
   {0x46000100,0X41a14583}, // 8192.25
   {0x46000200,0X41a145ef}, // 8192.5
   {0x46800000,0X41cb2ff5}, // 16384
   {0x46800080,0X41cb3039}, // 16384.2
   {0x46800100,0X41cb307d}, // 16384.5
   {0x47000000,0X42000000}, // 32768
   {0x47000040,0X42000015}, // 32768.2
   {0x47000080,0X4200002b}, // 32768.5
   {0x47800000,0X42214518}, // 65536
   {0x47800020,0X42214525}, // 65536.2
   {0x47800040,0X42214533}, // 65536.5
   {0x48000000,0X424b2ff5}, // 131072
   {0x48000010,0X424b2ffe}, // 131072
   {0x48000020,0X424b3006}, // 131072
   {0x48800000,0X42800000}, // 262144
   {0x48800008,0X42800003}, // 262144
   {0x48800010,0X42800005}, // 262144
   {0x49000000,0X42a14518}, // 524288
   {0x49000004,0X42a14519}, // 524288
   {0x49000008,0X42a1451b}, // 524288
   {0x49800000,0X42cb2ff5}, // 1.04858e+06
   {0x49800002,0X42cb2ff6}, // 1.04858e+06
   {0x49800004,0X42cb2ff7}, // 1.04858e+06
   {0x4a000000,0X43000000}, // 2.09715e+06
   {0x4a000001,0X43000000}, // 2.09715e+06
   {0x4a000002,0X43000001}, // 2.09715e+06
   {0x4a800000,0X43214518}, // 4.1943e+06
   {0x4b800000,0X43800000}, // 1.67772e+07
   {0x4c000000,0X43a14518}, // 3.35544e+07
   {0x4c800000,0X43cb2ff5}, // 6.71089e+07
   {0x4d000000,0X44000000}, // 1.34218e+08
   {0x4d800000,0X44214518}, // 2.68435e+08
   {0x4e000000,0X444b2ff5}, // 5.36871e+08
   {0x4e800000,0X44800000}, // 1.07374e+09
   {0x4f000000,0X44a14518}, // 2.14748e+09
   {0x4f800000,0X44cb2ff5}, // 4.29497e+09
   {0x50000000,0X45000000}, // 8.58993e+09
   {0x50800000,0X45214518}, // 1.71799e+10
   {0x51000000,0X454b2ff5}, // 3.43597e+10
   {0x7fffff,0X2a7fffff}, // 1.17549e-38
   {0x80000001,0Xa6a14518}, // -1.4013e-45
   {0x805def12,0Xaa66e923}, // -8.62646e-39
   {0x807fffff,0Xaa7fffff}, // -1.17549e-38
   {0x800000,0X2a800000}, // 1.17549e-38
   {0x43b3c4ea,0X40e38b39}, // 359.538
   {0x80800000,0Xaa800000}, // -1.17549e-38
   {0xc5812e71,0Xc1806481}, // -4133.81
   {0xff7fffff,0Xd4cb2ff5}, // -3.40282e+38
   {0xffc00000,0Xffc00000}, // nan
   {0xffc00001,0Xffc00001}, // nan
   {0xffd2ba31,0Xffd2ba31}, // nan
   {0xffffffff,0Xffffffff}, // nan
   {0xff800001,0Xffc00001}, // nan
   {0xff95fffa,0Xffd5fffa}, // nan
   {0xffbfffff,0Xffffffff}, // nan
   {0x3fc90fdb,0X3f94cb13}, // 1.5708
   {0x40490fdb,0X3fbb77bf}, // 3.14159
   {0x40c90fdb,0X3fec31d0}, // 6.28319
   {0x402df853,0X3fb2a36d}, // 2.71828
   {0x402df854,0X3fb2a36d}, // 2.71828
   {0x402df855,0X3fb2a36e}, // 2.71828
   {0x0,0X0}, // 0
   {0x37c0f01f,0X3ce8f836}, // 2.3e-05
   {0x3efffeb0,0X3f4b2f9c}, // 0.49999
   {0x3f0000c9,0X3f4b3060}, // 0.500012
   {0xb7c0f01f,0Xbce8f836}, // -2.3e-05
   {0xbefffeb0,0Xbf4b2f9c}, // -0.49999
   {0xbf0000c9,0Xbf4b3060}, // -0.500012
   {0x3f800000,0X3f800000}, // 1
   {0x3f700001,0X3f7a8d31}, // 0.9375
   {0x3f87fffe,0X3f829ceb}, // 1.0625
   {0x3fbfffac,0X3f9285ea}, // 1.49999
   {0x3fc00064,0X3f928618}, // 1.50001
   {0xbf800000,0Xbf800000}, // -1
   {0xbf700001,0Xbf7a8d31}, // -0.9375
   {0xbf87fffe,0Xbf829ceb}, // -1.0625
   {0xbfbfffac,0Xbf9285ea}, // -1.49999
   {0xbfc00064,0Xbf928618}, // -1.50001
   {0x40000000,0X3fa14518}, // 2
   {0xc0000000,0Xbfa14518}, // -2
   {0x41200000,0X4009e242}, // 10
   {0xc1200000,0Xc009e242}, // -10
   {0x447a0000,0X41200000}, // 1000
   {0xc47a0000,0Xc1200000}, // -1000
   {0x4286cccc,0X40823a48}, // 67.4
   {0xc286cccc,0Xc0823a48}, // -67.4
   {0x44f7f333,0X414908ec}, // 1983.6
   {0xc4f7f333,0Xc14908ec}, // -1983.6
   {0x42af0000,0X408e108c}, // 87.5
   {0xc2af0000,0Xc08e108c}, // -87.5
   {0x48015e40,0X424be8a1}, // 132473
   {0xc8015e40,0Xc24be8a1}, // -132473
   {0x4b000001,0X434b2ff6}, // 8.38861e+06
   {0x4affffff,0X434b2ff5}, // 8.38861e+06
   {0xcb000000,0Xc34b2ff5}, // -8.38861e+06
   {0xcb000001,0Xc34b2ff6}, // -8.38861e+06
   {0xcaffffff,0Xc34b2ff5}, // -8.38861e+06
   {0x7f7fffff,0X54cb2ff5}, // 3.40282e+38
   {0x7fe00000,0X7fe00000}, // nan
   {0x7fb00000,0X7ff00000}, // nan
   {0x7fc00000,0X7fc00000}, // nan
   {0x7fe1a570,0X7fe1a570}, // nan
   {0x7fffffff,0X7fffffff}, // nan
   {0x7f800001,0X7fc00001}, // nan
   {0x7fa0bd90,0X7fe0bd90}, // nan
   {0x7fbfffff,0X7fffffff}, // nan

   {0x7f800000,0x7f800000}, 
   {0xff800000,0xff800000},


   {0x43ab8000,0x40e00000}, // 343, 7
   {0xc4000000,0xc1000000}, // -512, -8
   {0x4a1cf164,0x43090000}, // 2571353, 137
   {0xc9266000,0xc2b00000}, // -681472, -88
   {0x49b4cc08,0x42e3fa06}, // 1481089
   {0x363eecba,0x3c68280b}, // 2.845E-06
   {0x3d800000,0x3ecb2ff5}, // 0.0625
   {0xc20a1eb8,0xc050682d}, // -34.53
   {0xbe99999a,0xbf2b5ff5}, // -0.3
   {0xbf247208,0xbf5ce2b2}, // -0.642365
   {0x3e99999a,0x3f2b5ff5}, // 0.3
   {0x3f247208,0x3f5ce2b2}, // 0.642365
   {0x3f000000,0x3f4b2ff5}, // 0.5
   {0x420a1eb8,0x4050682d}, // 34.53
   {0x46de66b6,0x41f44571}, // 28467.3555
   {0xc2c80000,0xc09487e5}, // -100
   {0x42c80000,0x409487e5}, // 100
   {0x718f0f0f,0x50275c7a}, // 1.416786E+30
   {0x00080000,0x29cb2ff5}, // 2^-130
};


static libm_test_special_data_f64
test_cbrt_conformance_data[] = {
    // special accuracy tests
    {0x7ff0000000000001,0x7ff8000000000001,FE_INVALID},
    {0xfff0000000000001,0xfff8000000000001,FE_INVALID},
    {0x7ff8000000000000,0x7ff8000000000000,0},
    {0xfff8000000000000,0xfff8000000000000,0},
    {0x7ff0000000000000,0x7ff0000000000000,0},
    {0xfff0000000000000,0xfff0000000000000,0},
    {0x3ff0000000000000,0x3ff0000000000000,0},
    {0xbff0000000000000,0xbff0000000000000,0},
    {0x0,0x0,0},
    {0x8000000000000000,0x8000000000000000,0},
    {0xfffffffffffff,0x2aa428a2f98d728a,0},
    {0x800fffffffffffff,0xaaa428a2f98d728a,0},
    {0x1,0x2990000000000000,0},
    {0x8000000000000001,0xa990000000000000,0},
    {0x7fefffffffffffff,0x554428a2f98d728b,0},
    {0xffefffffffffffff,0xd54428a2f98d728b,0},
    {0x10000000000000,0x2aa428a2f98d728b,0},
    {0x8010000000000000,0xaaa428a2f98d728b,0},
    {0x400921fb60000000,0x3ff76ef7ead69852,0},
    {0xc00921fb60000000,0xbff76ef7ead69852,0},
    {0x3ff921fb60000000,0x3ff2996267c5deee,0},
    {0xbff921fb60000000,0xbff2996267c5deee,0},
    {0x1ff09cff6,0x2a3ffade2d204819,0},
    {0x3fdffffbce4217d3,0x3fe965fd8929cd67,0}, // (0.499999 ,0.499999)^1/3 = (0.7937 ,0.793700)
    {0x8000000000000000,0x8000000000000000,0}, // (-0 ,-0.000000)^1/3 = (-0 ,-0.000000)
    {0x1,0x2990000000000000,0}   , // (4.94066e-324 ,0.000000)^1/3 = (1.70318e-108 ,0.000000)
    {0x5fde623545abc,0x2a9d0f87e1bd5c8a,0}, // (8.33261e-309 ,0.000000)^1/3 = (2.02734e-103 ,0.000000)
    {0xfffffffffffff,0x2aa428a2f98d728a,0}, // (2.22507e-308 ,0.000000)^1/3 = (2.81264e-103 ,0.000000)
    {0x8000000000000001,0xa990000000000000,0}, // (-4.94066e-324 ,-0.000000)^1/3 = (-1.70318e-108 ,-0.000000)
    {0x8002344ade5def12,0xaa94d2aa3036cd87,0}, // (-3.06541e-309 ,-0.000000)^1/3 = (-1.45266e-103 ,-0.000000)
    {0x88f2344ade5def12,0xad9a83d4bb116375,0}, // (-3.06541e-309 ,-0.000000)^1/3 = (-1.45266e-103 ,-0.000000)
    {0x800fffffffffffff,0xaaa428a2f98d728a,0}, // (-2.22507e-308 ,-0.000000)^1/3 = (-2.81264e-103 ,-0.000000)
    {0x10000000000000,0x2aa428a2f98d728b,0}, // (2.22507e-308 ,0.000000)^1/3 = (2.81264e-103 ,0.000000)
    {0x8010000000000000,0xaaa428a2f98d728b,0}, // (-2.22507e-308 ,-0.000000)^1/3 = (-2.81264e-103 ,-0.000000)
    {0x43f800876abcda00,0x4147139faf7044d9,0}, // (2.76725e+19 ,27672498390639312896.000000)^1/3 = (3.0247e+06 ,3024703.370614)
    {0x44080091781cdba0,0x414d1327c8354fcc,0}, // (5.53454e+19 ,55345350463248924672.000000)^1/3 = (3.8109e+06 ,3810895.564127)
    {0x4408012786abcde0,0x414d13645ebbb035,0}, // (5.53506e+19 ,55350630119951302656.000000)^1/3 = (3.81102e+06 ,3811016.740103)
    {0xffefffffffffffff,0xd54428a2f98d728b,0}, // (-1.79769e+308 ,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000)^1/3 = (-5.6438e+102 ,-5643803094122362298386835960720996333881089063696129532042408160730270011663197773501163653620081623040.000000)
    {0xc0862c4379671324,0xc021d69cc4f64c8e,0}, // (-709.533 ,-709.532946)^1/3 = (-8.91916 ,-8.919165)
    {0x3e45798ee2308c3a,0x3f61a62d511f2b53,0}, // (1e-08 ,0.000000)^1/3 = (0.00215443 ,0.002154)
    {0x3fb999999999999a,0x3fddb4c7760bcff3,0}, // (0.1 ,0.100000)^1/3 = (0.464159 ,0.464159)
    {0x3fe0000000000000,0x3fe965fea53d6e3d,0}, // (0.5 ,0.500000)^1/3 = (0.793701 ,0.793701)
    {0x3feccccccccccccd,0x3feee549fe7085e7,0}, // (0.9 ,0.900000)^1/3 = (0.965489 ,0.965489)
    {0x3ffe666666666666,0x3ff3d126bbbd1b43,0}, // (1.9 ,1.900000)^1/3 = (1.23856 ,1.238562)
    {0xbe45798ee2308c3a,0xbf61a62d511f2b53,0}, // (-1e-08 ,-0.000000)^1/3 = (-0.00215443 ,-0.002154)
    {0xbfb999999999999a,0xbfddb4c7760bcff3,0}, // (-0.1 ,-0.100000)^1/3 = (-0.464159 ,-0.464159)
    {0xbfe0000000000000,0xbfe965fea53d6e3d,0}, // (-0.5 ,-0.500000)^1/3 = (-0.793701 ,-0.793701)
    {0xbfeccccccccccccd,0xbfeee549fe7085e7,0}, // (-0.9 ,-0.900000)^1/3 = (-0.965489 ,-0.965489)
    {0xbff199999999999a,0xbff08438278323a4,0}, // (-1.1 ,-1.100000)^1/3 = (-1.03228 ,-1.032280)
    {0xbff8000000000000,0xbff250bfe1b082f5,0}, // (-1.5 ,-1.500000)^1/3 = (-1.14471 ,-1.144714)
    {0xbffe666666666666,0xbff3d126bbbd1b43,0}, // (-1.9 ,-1.900000)^1/3 = (-1.23856 ,-1.238562)
    {0xbff0000000000000,0xbff0000000000000,0}, // (-1 ,-1.000000)^1/3 = (-1 ,-1.000000)
    {0x4024000000fff000,0x40013c484181f573,0}, // (10 ,10.000000)^1/3 = (2.15443 ,2.154435)
    {0x408f4fff00000000,0x4024036904b5157e,0}, // (1002 ,1001.999512)^1/3 = (10.0067 ,10.006661)
    {0x408f4c0000000000,0x4024028f08580058,0}, // (1001.5 ,1001.500000)^1/3 = (10.005 ,10.004998)
    {0x409003999999999a,0x40242a25e8c2dfa3,0}, // (1024.9 ,1024.900000)^1/3 = (10.0823 ,10.082320)
    {0x42cf000000000000,0x40e3f24f62645865,0}, // (6.81697e+13 ,68169720922112.000000)^1/3 = (40850.5 ,40850.480761)
    {0x42c80000000fffff,0x40e250bfe1b494e6,0}, // (5.27766e+13 ,52776558141439.992188)^1/3 = (37510 ,37509.996302)
    {0x42d10237f00fffff,0x40e492e11d5ec942,0}, // (7.48049e+13 ,74804904345599.984375)^1/3 = (42135 ,42135.034835)
    {0x42e1067adfc342b0,0x40e9ee042bddccf1,0}, // (1.49756e+14 ,149756231686677.500000)^1/3 = (53104.1 ,53104.130355)
    {0x42e1067adfc34208,0x40e9ee042bddcc9c,0}, // (1.49756e+14 ,149756231686672.250000)^1/3 = (53104.1 ,53104.130355)
    {0x42e800000091fabf,0x40ed12ed0b2c94f9,0}, // (2.11106e+14 ,211106232831957.968750)^1/3 = (59543.4 ,59543.407614)
    {0x42f8000001234fcf,0x40f250bfe1fa9d9f,0}, // (4.22212e+14 ,422212466259196.937500)^1/3 = (75020 ,75019.992671)
    {0x42f80000000cccf8,0x40f250bfe1b3c48e,0}, // (4.22212e+14 ,422212465118415.500000)^1/3 = (75020 ,75019.992603)
    {0x43010237f0ccdfff,0x40f492e11daaf0d8,0}, // (5.98439e+14 ,598439236312063.875000)^1/3 = (84270.1 ,84270.069743)
    {0x430800056891fa02,0x40f7137604d34ca5,0}, // (8.44428e+14 ,844427833786176.250000)^1/3 = (94519.4 ,94519.376178)
    {0x43110237f00000ff,0x40f9ebda2782c2a7,0}, // (1.19688e+15 ,1196878469267519.750000)^1/3 = (106174 ,106173.634646)
    {0x43110237f00000fe,0x40f9ebda2782c2a6,0}, // (1.19688e+15 ,1196878469267519.500000)^1/3 = (106174 ,106173.634646)
    {0x4321ffffffffffff,0x4100a402fcc79298,0}, // (2.53327e+15 ,2533274790395903.500000)^1/3 = (136320 ,136320.373428)
    {0x43210237f00000ff,0x410054532d8952a7,0}, // (2.39376e+15 ,2393756938535039.500000)^1/3 = (133770 ,133770.397235)
    {0x43310237f00000ff,0x410492e11d585626,0}, // (4.78751e+15 ,4787513877070079.000000)^1/3 = (168540 ,168540.139329)
    {0x433800056891fa00,0x4107137604d34ca4,0}, // (6.75542e+15 ,6755422670289408.000000)^1/3 = (189039 ,189038.752356)
    {0x4378000000000000,0x411d12ed0af1a27f,0}, // (1.08086e+17 ,108086391056891904.000000)^1/3 = (476347 ,476347.260687)
    {0xc5812e71245acfdb,0xc1ca023dfc1e8e4d,0}, // (-6.64674e+26 ,-664673756588022451306233856.000000)^1/3 = (-8.72709e+08 ,-872709112.238718)
    {0xffefffffffffffff,0xd54428a2f98d728b,0}, // (-1.79769e+308 ,-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000)^1/3 = (-5.6438e+102 ,-5643803094122362298386835960720996333881089063696129532042408160730270011663197773501163653620081623040.000000)
    {0x3ff921fb54442d18,0x3ff2996264e0e3fe,0}, // (1.5708 ,1.570796)^1/3 = (1.16245 ,1.162447)
    {0x400921fb54442d18,0x3ff76ef7e73104b7,0}, // (3.14159 ,3.141593)^1/3 = (1.46459 ,1.464592)
    {0x401921fb54442d18,0x3ffd8639fdcb60ea,0}, // (6.28319 ,6.283185)^1/3 = (1.84527 ,1.845270)
    {0x3ffb7e151628aed3,0x3ff329f7e9744467,0}, // (1.71828 ,1.718282)^1/3 = (1.19775 ,1.197746)
    {0x4005bf0a8b145769,0x3ff6546db1ba2d13,0}, // (2.71828 ,2.718282)^1/3 = (1.39561 ,1.395612)
    {0x400dbf0a8b145769,0x3ff8c99eacdcafa5,0}, // (3.71828 ,3.718282)^1/3 = (1.54922 ,1.549224)
    {0x3c4536b8b14b676c,0x3eb625621463f313,0}, // (2.3e-18 ,0.000000)^1/3 = (1.32001e-06 ,0.000001)
    {0x3fe000000000006c,0x3fe965fea53d6e76,0}, // (0.5 ,0.500000)^1/3 = (0.793701 ,0.793701)
    {0x8000000000000000,0x8000000000000000,0}, // (-0 ,-0.000000)^1/3 = (-0 ,-0.000000)
    {0xbbdb2752ce74ff42,0xbe9315b9ecc4ce0f,0}, // (-2.3e-20 ,-0.000000)^1/3 = (-2.84387e-07 ,-0.000000)
    {0xbfdffffbce4217d3,0xbfe965fd8929cd67,0}, // (-0.499999 ,-0.499999)^1/3 = (-0.7937 ,-0.793700)
    {0xbfe000000000006c,0xbfe965fea53d6e76,0}, // (-0.5 ,-0.500000)^1/3 = (-0.793701 ,-0.793701)
    {0x3ff0000000000000,0x3ff0000000000000,0}, // (1 ,1.000000)^1/3 = (1 ,1.000000)
    {0x3fefffffc49bd0dc,0x3fefffffec33f03d,0}, // (1 ,1.000000)^1/3 = (1 ,1.000000)
    {0x3ff0000000000119,0x3ff000000000005e,0}, // (1 ,1.000000)^1/3 = (1 ,1.000000)
    {0x3ff7fffef39085f4,0x3ff250bf9d679517,0}, // (1.5 ,1.499999)^1/3 = (1.14471 ,1.144714)
    {0x3ff8000000000001,0x3ff250bfe1b082f5,0}, // (1.5 ,1.500000)^1/3 = (1.14471 ,1.144714)
    {0xbff0000000000000,0xbff0000000000000,0}, // (-1 ,-1.000000)^1/3 = (-1 ,-1.000000)
    {0xbfefffffc49bd0dc,0xbfefffffec33f03d,0}, // (-1 ,-1.000000)^1/3 = (-1 ,-1.000000)
    {0xbff0000000000119,0xbff000000000005e,0}, // (-1 ,-1.000000)^1/3 = (-1 ,-1.000000)
    {0xbff7fffef39085f4,0xbff250bf9d679517,0}, // (-1.5 ,-1.499999)^1/3 = (-1.14471 ,-1.144714)
    {0xbff8000000000001,0xbff250bfe1b082f5,0}, // (-1.5 ,-1.500000)^1/3 = (-1.14471 ,-1.144714)
    {0x4000000000000000,0x3ff428a2f98d728b,0}, // (2 ,2.000000)^1/3 = (1.25992 ,1.259921)
    {0xc000000000000000,0xbff428a2f98d728b,0}, // (-2 ,-2.000000)^1/3 = (-1.25992 ,-1.259921)
    {0x4024000000000000,0x40013c484138704f,0}, // (10 ,10.000000)^1/3 = (2.15443 ,2.154435)
    {0xc024000000000000,0xc0013c484138704f,0}, // (-10 ,-10.000000)^1/3 = (-2.15443 ,-2.154435)
    {0x408f400000000000,0x4024000000000000,0}, // (1000 ,1000.000000)^1/3 = (10 ,10.000000)
    {0xc08f400000000000,0xc024000000000000,0}, // (-1000 ,-1000.000000)^1/3 = (-10 ,-10.000000)
    {0x4050d9999999999a,0x4010474916e2d86b,0}, // (67.4 ,67.400000)^1/3 = (4.06961 ,4.069615)
    {0xc050d9999999999a,0xc010474916e2d86b,0}, // (-67.4 ,-67.400000)^1/3 = (-4.06961 ,-4.069615)
    {0x409efe6666666666,0x4029211d7cc31cbd,0}, // (1983.6 ,1983.600000)^1/3 = (12.5647 ,12.564678)
    {0xc09efe6666666666,0xc029211d7cc31cbd,0}, // (-1983.6 ,-1983.600000)^1/3 = (-12.5647 ,-12.564678)
    {0x4055e00000000000,0x4011c211887d70a0,0}, // (87.5 ,87.500000)^1/3 = (4.43952 ,4.439520)
    {0xc055e00000000000,0xc011c211887d70a0,0}, // (-87.5 ,-87.500000)^1/3 = (-4.43952 ,-4.439520)
    {0x41002bc800000000,0x40497d142b9b48df,0}, // (132473 ,132473.000000)^1/3 = (50.9772 ,50.977178)
    {0xc1002bc800000000,0xc0497d142b9b48df,0}, // (-132473 ,-132473.000000)^1/3 = (-50.9772 ,-50.977178)
    {0xc330000000000000,0xc10428a2f98d728b,0}, // (4.5036e+15 ,4503599627370496.000000)^1/3 = (165140 ,165140.371852)
    {0x4330000000000001,0x410428a2f98d728b,0}, // (4.5036e+15 ,4503599627370497.000000)^1/3 = (165140 ,165140.371852)
    {0x432fffffffffffff,0x410428a2f98d728b,0}, // (4.5036e+15 ,4503599627370495.500000)^1/3 = (165140 ,165140.371852)
    {0xc330000000000000,0xc10428a2f98d728b,0}, // (-4.5036e+15 ,-4503599627370496.000000)^1/3 = (-165140 ,-165140.371852)
    {0xc330000000000001,0xc10428a2f98d728b,0}, // (-4.5036e+15 ,-4503599627370497.000000)^1/3 = (-165140 ,-165140.371852)
    {0xc32fffffffffffff,0xc10428a2f98d728b,0}, // (-4.5036e+15 ,-4503599627370495.500000)^1/3 = (-165140 ,-165140.371852)
    {0x43480677adfcfa00,0x410d1589611a8eb5,0}, // (1.3525e+16 ,13525021061936128.000000)^1/3 = (238257 ,238257.172414)
    {0x435801239871fa00,0x4112510a0da873d6,0}, // (2.70266e+16 ,27026607336581120.000000)^1/3 = (300099 ,300098.513338)
    {0x4368111144444444,0x411718eb571e0c64,0}, // (5.41933e+16 ,54193322387972640.000000)^1/3 = (378427 ,378426.835076)
    {0x4388ffffffffffff,0x412290fca9c761f7,0}, // (2.2518e+17 ,225179981368524768.000000)^1/3 = (608382 ,608382.331599)
    {0x4398ffffffffffff,0x412764636974629c,0}, // (4.5036e+17 ,450359962737049536.000000)^1/3 = (766514 ,766513.705966)
    {0x43a8ffffffffffff,0x412d78e581a0c12f,0}, // (9.0072e+17 ,900719925474099072.000000)^1/3 = (965747 ,965746.753180)
    {0x43b8aaaa68ffffff,0x41327bc48aac21de,0}, // (1.77742e+18 ,1777420370899369728.000000)^1/3 = (1.21133e+06 ,1211332.541689)
    {0x43c8aaaa69ffffff,0x413749a75e71ee87,0}, // (3.55484e+18 ,3554840750388674048.000000)^1/3 = (1.52618e+06 ,1526183.368926)
    {0x43d8009678abcd00,0x413d1329cd456a1b,0}, // (6.91819e+18 ,6918190807731404800.000000)^1/3 = (1.90545e+06 ,1905449.801840)
    {0x7fefffffffffffff,0x554428a2f98d728b,0}, //(1.79769e+308 ,179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000)^1/3 = (5.6438e+102 ,5643803094122362298386835960720996333881089063696129532042408160730270011663197773501163653620081623040.000000)
    {0x43e8098734209870,0x4142532c0c4c744c,0}, // (1.38565e+19 ,13856513517244612608.000000)^1/3 = (2.40188e+06 ,2401880.096083)
    {0x43b3c4eafedcab02,0x41312b3ea8218c32,0}, // (1.42452e+18 ,1424521762500706816.000000)^1/3 = (1.12518e+06 ,1125182.656762)

    /* The following is the error case identified by Paul Zimmermann */
    {0x80001fffffffffff, 0xaa7fffffffffffab, 0} // (-1.73833895195870167397466018576152301829197566259896e-310 ,-0.000000)^1/3 = (-5.5809931214954306443504636562311623283571665772106e-104 ,-0.000000)

};

